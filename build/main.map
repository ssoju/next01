{"version":3,"sources":["webpack:///webpack/bootstrap 041d61dc5691a25d906a","webpack:///external \"mongoose\"","webpack:///external \"babel-runtime/regenerator\"","webpack:///external \"babel-runtime/helpers/asyncToGenerator\"","webpack:///./server/config/index.js","webpack:///external \"koa-router\"","webpack:///external \"jsonwebtoken\"","webpack:///./server/index.js","webpack:///./nuxt.config.js","webpack:///external \"body-parser\"","webpack:///external \"express-session\"","webpack:///external \"koa\"","webpack:///external \"nuxt\"","webpack:///external \"koa-static\"","webpack:///external \"koa-bodyparser\"","webpack:///external \"@koa/cors\"","webpack:///./server/routes/index.js","webpack:///./server/middlewares/check-token.js","webpack:///./server/models/user.js","webpack:///./server/models/article.js","webpack:///./server/models/tag.js","webpack:///./server/controllers/user.js","webpack:///external \"md5\"","webpack:///./server/controllers/tag.js","webpack:///./server/controllers/article.js","webpack:///external \"path\"","webpack:///external \"fs\"","webpack:///external \"formidable\""],"names":["user","role","username","password","email","nickname","motto","avatar","jwt","secret","mongodb","host","database","port","production","domain","app","routerBaseApi","process","env","HOST","PORT","router","use","routes","allowedMethods","config","require","dev","nuxt","builder","build","ctx","next","status","Promise","resolve","reject","res","on","render","req","promise","then","catch","listen","console","log","start","bodyParser","session","module","exports","head","title","meta","charset","name","content","hid","link","rel","type","href","css","loading","color","middleware","scrollBehavior","to","from","savedPosition","position","matched","length","x","y","some","r","components","default","options","scrollToTop","hash","selector","extendRoutes","plugins","serverMiddleware","json","resave","saveUninitialized","cookie","maxAge","extractCSS","allChunks","vendor","manifest","description","theme_color","modules","tag","article","prefix","get","getUserInfo","patch","patchUserInfo","post","login","logout","getTagsOrArticles","postTag","patchTag","del","deleteTag","search","getArticle","getArticles","getPrivateArticles","archives","postArticle","upload","patchArticle","deleteArticle","User","model","token","decoded","verify","userID","findOne","_id","exec","body","success","err","Schema","UserSchema","String","createdAt","Date","now","updatedAt","toJSON","virtuals","versionKey","transform","doc","ret","id","ArticleSchema","publish","Boolean","views","Number","flag","like","Array","comments","tags","Types","ObjectId","ref","TagSchema","request","expiresIn","sign","cookies","set","data","avatarUrl","protocol","oldPassword","newPassword","findOneAndUpdate","Tag","Article","params","find","populate","path","select","sort","save","findByIdAndUpdate","findByIdAndRemove","page","limit","total","skip","keyword","reg","RegExp","$or","$regex","articles","arr","arr2","year","month","date","i","getFullYear","getMonth","push","archiveArticles","j","getImgUrl","form","parse","fields","files","lastItem","Object","keys","extname","oldUrl","newUrl","readStream","createReadStream","writeStream","createWriteStream","pipe","imgUrl","IncomingForm","url"],"mappings":"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","file":"main.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 6);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 041d61dc5691a25d906a","module.exports = require(\"mongoose\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"mongoose\"\n// module id = 0\n// module chunks = 0","module.exports = require(\"babel-runtime/regenerator\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"babel-runtime/regenerator\"\n// module id = 1\n// module chunks = 0","module.exports = require(\"babel-runtime/helpers/asyncToGenerator\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"babel-runtime/helpers/asyncToGenerator\"\n// module id = 2\n// module chunks = 0","export default {\n  user: {\n    role: 'superAdmin',\n    username: 'demo',\n    password: 'demo',\n    email: 'comahead@gmail.com',\n    nickname: 'VueBlog',\n    motto: 'Never too old to learn',\n    avatar: 'avatar.png'\n  },\n  jwt: {\n    secret: 'vueblog'\n  },\n  mongodb: {\n    host: 'ds255889.mlab.com',\n    database: 'vueblogs',\n    port: 55889,\n    username: 'comahead',\n    password: 'qazx1234'\n  },\n  production: {\n    host: 'localhost',\n    domain: 'https://localhost'\n    // domain: 'http://127.0.0.1:3000'\n  },\n  app: {\n    host: 'localhost',\n    port: 3000,\n    routerBaseApi: '/api'\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./server/config/index.js","module.exports = require(\"koa-router\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"koa-router\"\n// module id = 4\n// module chunks = 0","module.exports = require(\"jsonwebtoken\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"jsonwebtoken\"\n// module id = 5\n// module chunks = 0","import Koa from 'koa'\nimport { Nuxt, Builder } from 'nuxt'\nimport KoaStatic from 'koa-static'\nimport bodyParser from 'koa-bodyparser'\nimport Router from 'koa-router'\nimport cors from '@koa/cors'\nimport globalConfig from './config'\nimport route from './routes'\n\nasync function start() {\n  const app = new Koa()\n  const host = process.env.HOST || globalConfig.app.host\n  const port = process.env.PORT || globalConfig.app.port\n  const router = new Router()\n\n  app.use(cors())\n  app.use(bodyParser())\n  app.use(KoaStatic('.'))\n  router.use('', route.routes())\n  app\n    .use(router.routes())\n    .use(router.allowedMethods())\n\n  // Import and Set Nuxt.js options\n  let config = require('../nuxt.config.js')\n  config.dev = !(app.env === 'production')\n\n  // Instantiate nuxt.js\n  const nuxt = new Nuxt(config)\n\n  // Build in development\n  if (config.dev) {\n    const builder = new Builder(nuxt)\n    await builder.build()\n  }\n\n  app.use(async (ctx, next) => {\n    await next()\n    ctx.status = 200 // koa defaults to 404 when it sees that status is unset\n    return new Promise((resolve, reject) => {\n      ctx.res.on('close', resolve)\n      ctx.res.on('finish', resolve)\n      nuxt.render(ctx.req, ctx.res, promise => {\n        // nuxt.render passes a rejected promise into callback on error.\n        promise.then(resolve).catch(reject)\n      })\n    })\n  })\n\n  app.listen(port, host)\n  console.log('Server listening on ' + host + ':' + port) // eslint-disable-line no-console\n}\n\nstart()\n\n\n\n// WEBPACK FOOTER //\n// ./server/index.js","const bodyParser = require('body-parser')\nconst session = require('express-session')\n\nmodule.exports = {\n  /*\n  ** Headers of the page\n  */\n  head: {\n    title: 'vinylc family',\n    meta: [\n      {charset: 'utf-8'},\n      {name: 'viewport', content: 'width=device-width, initial-scale=1'},\n      {hid: 'description', name: 'description', content: 'Nuxt.js project'}\n    ],\n    link: [\n      {rel: 'icon', type: 'image/x-icon', href: '/favicon.ico'}\n    ],\n  },\n  css: [\n    '~assets/css/common.scss'\n  ],\n  /*\n  ** Customize the progress bar color\n  */\n  loading: {color: '#3B8070'},\n  ////loading: false,\n\n  router: {\n    middleware: ['i18n'],\n    scrollBehavior(to, from, savedPosition) {\n      // savedPosition은 오직 popstate 동작으로 가능합니다.\n      if (savedPosition) {\n        return savedPosition\n      } else {\n        let position = {}\n        // 만약 children 요소가 감지되지 않는다면\n        if (to.matched.length < 2) {\n          // 페이지 상단으로 스크롤됩니다.\n          position = {x: 0, y: 0}\n        }\n        else if (to.matched.some((r) => r.components.default.options.scrollToTop)) {\n          // 어떤 자식요소가 scrollToTop 옵션으로 설정되어있다면\n          position = {x: 0, y: 0}\n        }\n        // link가 anchor를 가지고 있을 경우, 반환된 선택자를 이용해 anchor로 이동합니다.\n        if (to.hash) {\n          position = {selector: to.hash}\n        }\n        return position\n      }\n    },\n    extendRoutes(routes, resolve) {\n      /*routes.push({\n        name: 'custom',\n        path: '*',\n        component: resolve(__dirname, 'pages/404.vue')\n      })*/\n    }\n  },\n\n  plugins: ['@/plugins/i18n.js', '@/plugins/axios.js'],\n\n  serverMiddleware: [\n    bodyParser.json(),\n    session({\n      secret: 'super-secret-key',\n      resave: true,\n      saveUninitialized: false,\n      cookie: { maxAge: 60000 }\n    })\n  ],\n\n  //proxy: 'http://word.api.maru.zone/api/v1',\n\n  /*\n  ** Build configuration\n  */\n  build: {\n    extractCSS: {\n      allChunks: true\n    },\n\n    vendor: ['axios'],\n\n    /*\n    ** Run ESLint on save\n    */\n    /*extend(config, {isDev, isClient}) {\n      if (isDev && isClient) {\n        config.module.rules.push({\n          enforce: 'pre',\n          test: /\\.(js|vue)$/,\n          loader: 'eslint-loader',\n          exclude: /(node_modules)/\n        })\n      }\n    },*/\n\n  },\n\n  manifest: {\n    name: 'family',\n    description: '...',\n    theme_color: '#000000'\n  },\n\n  modules: ['@nuxtjs/pwa', '@nuxtjs/axios']\n}\n\n\n\n// WEBPACK FOOTER //\n// ./nuxt.config.js","module.exports = require(\"body-parser\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"body-parser\"\n// module id = 8\n// module chunks = 0","module.exports = require(\"express-session\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"express-session\"\n// module id = 9\n// module chunks = 0","module.exports = require(\"koa\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"koa\"\n// module id = 10\n// module chunks = 0","module.exports = require(\"nuxt\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"nuxt\"\n// module id = 11\n// module chunks = 0","module.exports = require(\"koa-static\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"koa-static\"\n// module id = 12\n// module chunks = 0","module.exports = require(\"koa-bodyparser\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"koa-bodyparser\"\n// module id = 13\n// module chunks = 0","module.exports = require(\"@koa/cors\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"@koa/cors\"\n// module id = 14\n// module chunks = 0","import Router from 'koa-router'\nimport config from '../config'\nimport checkToken from '../middlewares/check-token'\n\nconst router = new Router({\n  prefix: config.app.routerBaseApi\n})\n\nimport * as user from '../controllers/user'\nimport * as tag from '../controllers/tag'\nimport * as article from '../controllers/article'\n\nrouter\n  .get('/user', user.getUserInfo)\n  .patch('/user', checkToken, user.patchUserInfo)\n  .post('/login', user.login)\n  .post('/logout', checkToken, user.logout)\n\nrouter\n  .get('/tags/:id?', tag.getTagsOrArticles)\n  .post('/tag', checkToken, tag.postTag)\n  .patch('/tag', checkToken, tag.patchTag)\n  .del('/tag/:id?', checkToken, tag.deleteTag)\n\nrouter\n  .get('/search/:keyword?', article.search)\n  .get('/article/:id?', article.getArticle)\n  .get('/articles/:page?/:limit?', article.getArticles)\n  .get('/private-articles', checkToken, article.getPrivateArticles)\n  .get('/archives', article.archives)\n  .post('/article', checkToken, article.postArticle)\n  .post('/upload', checkToken, article.upload)\n  .patch('/article', checkToken, article.patchArticle)\n  .del('/article/:id?', checkToken, article.deleteArticle)\n\nexport default router\n\n\n\n// WEBPACK FOOTER //\n// ./server/routes/index.js","import mongoose from 'mongoose'\nimport jwt from 'jsonwebtoken'\nimport config from '../config'\n\nrequire('../models/user')\nrequire('../models/article')\nrequire('../models/tag')\nconst User = mongoose.model('User')\n\nexport default async(ctx, next) => {\n  const token = ctx.get('token')\n  if (token) {\n    const decoded = jwt.verify(token, config.jwt.secret)\n    const username = decoded.username\n    const userID = decoded.userID\n    try {\n      let user = await User.findOne({ _id: userID, username: username }).exec()\n      if (user._id && user.username) {\n        await next()\n      } else {\n        return (ctx.body = {\n          success: false,\n          err: 'Token is invalid'\n        })\n      }\n    } catch (e) {\n      return (ctx.body = {\n        success: false,\n        err: e\n      })\n    }\n  } else {\n    return (ctx.body = {\n      success: false,\n      err: 'Please login'\n    })\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./server/middlewares/check-token.js","import mongoose from 'mongoose'\nconst Schema = mongoose.Schema\n\nconst UserSchema = new Schema({\n  role: {\n    type: String,\n    default: 'user'\n  },\n  username: String,\n  password: String,\n  email: String,\n  nickname: String,\n  motto: String,\n  avatar: String,\n  createdAt: {\n    type: Date,\n    default: Date.now\n  },\n  updatedAt: {\n    type: Date,\n    default: Date.now\n  }\n})\n\n// hidden some field\nUserSchema.options.toJSON = {\n  virtuals: true,\n  versionKey: false,\n  transform(doc, ret) {\n    ret.id = ret._id\n    delete ret._id\n    delete ret.id\n    delete ret.password\n    delete ret.username\n  }\n}\nmongoose.model('User', UserSchema)\n\n\nexport default UserSchema\n\n\n\n// WEBPACK FOOTER //\n// ./server/models/user.js","import mongoose from 'mongoose'\nconst Schema = mongoose.Schema\n\nconst ArticleSchema = new Schema({\n  title: String,\n  content: String,\n  publish: {\n    type: Boolean,\n    default: false\n  },\n  views: {\n    type: Number,\n    default: 0\n  },\n  flag: {\n    type: Number,\n    default: 1\n  },\n  like: {\n    type: Array,\n    default: []\n  },\n  comments: {\n    type: Array,\n    default: []\n  },\n  tags: [{\n    type: Schema.Types.ObjectId,\n    ref: 'Tag'\n  }],\n  createdAt: {\n    type: Date,\n    default: Date.now\n  },\n  updatedAt: {\n    type: Date,\n    default: Date.now\n  }\n})\n\nArticleSchema.options.toJSON = {\n  virtuals: true,\n  versionKey: false,\n  transform(doc, ret) {\n    ret.id = ret._id\n    delete ret._id\n  }\n}\n// db.articles.update({}, {$set: {flag: 1}}, {multi: 1})\nmongoose.model('Article', ArticleSchema)\n\nexport default ArticleSchema\n\n\n\n// WEBPACK FOOTER //\n// ./server/models/article.js","import mongoose from 'mongoose'\nconst Schema = mongoose.Schema\n\nconst TagSchema = new Schema({\n  name: {\n    type: String,\n    default: ''\n  },\n  createdAt: {\n    type: Date,\n    default: Date.now\n  },\n  updatedAt: {\n    type: Date,\n    default: Date.now\n  }\n})\n\nTagSchema.options.toJSON = {\n  virtuals: true,\n  versionKey: false,\n  transform(doc, ret) {\n    ret.id = ret._id\n    delete ret._id\n  }\n}\n\nmongoose.model('Tag', TagSchema)\n\nexport default TagSchema\n\n\n\n// WEBPACK FOOTER //\n// ./server/models/tag.js","import mongoose from 'mongoose'\nimport jwt from 'jsonwebtoken'\nimport md5 from 'md5'\nimport config from '../config'\n\nconst User = mongoose.model('User')\n\nexport const login = async(ctx, next) => {\n  let { username, password } = ctx.request.body\n  password = md5(password)\n  try {\n    let user = await User.findOne({username: username, password: password}).exec()\n    let secret = config.jwt.secret\n    let expiresIn = config.jwt.expiresIn\n    let token = jwt.sign({ username: user.username, userID: user._id }, secret)\n    ctx.cookies.set('token', token)\n    ctx.body = {\n      success: true,\n      data: {\n        token: token\n      }\n    }\n  } catch (e) {\n    ctx.body = {\n      success: false,\n      data: e\n    }\n  }\n}\n\nexport const logout = async(ctx, next) => {\n  ctx.cookies.set('token', null)\n  ctx.body = {\n    success: true,\n    data: {}\n  }\n}\n\nexport const getUserInfo = async(ctx, next) => {\n  let avatarUrl = ctx.protocol + '://' + ctx.host + '/public/' + config.user.avatar\n  try {\n    let data = await User.findOne({ role: 'superAdmin' }).exec()\n    data.avatar = avatarUrl\n    ctx.body = {\n      success: true,\n      data: data\n    }\n  } catch (e) {\n    ctx.body = {\n      success: false,\n      err: e\n    }\n  }\n}\n\nexport const patchUserInfo = async(ctx, next) => {\n  let body = ctx.request.body\n\n  if (body.oldPassword && body.newPassword) {\n    // update password\n    let oldPassword = md5(body.oldPassword)\n    let newPassword = md5(body.newPassword)\n    try {\n      let user = await User.findOne({ role: 'superAdmin' }).exec()\n      if (user.password !== oldPassword) {\n        return (ctx.body = {\n          success: false,\n          err: 'Wrong password'\n        })\n      }\n      body = await User.findOneAndUpdate({ role: 'superAdmin' }, { password: newPassword, updatedAt: Date.now() }).exec()\n      ctx.body = {\n        success: true,\n        data: body\n      }\n    } catch (e) {\n      ctx.body = {\n        success: false,\n        err: e\n      }\n    }\n  } else {\n    // update info\n    body.updatedAt = Date.now()\n    try {\n      body = await User.findOneAndUpdate({ role: 'superAdmin' }, body).exec()\n      ctx.body = {\n        success: true,\n        data: body\n      }\n    } catch (e) {\n      ctx.body = {\n        success: false,\n        err: e\n      }\n    }\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./server/controllers/user.js","module.exports = require(\"md5\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"md5\"\n// module id = 21\n// module chunks = 0","import mongoose from 'mongoose'\nconst Tag = mongoose.model('Tag')\nconst Article = mongoose.model('Article')\nexport const getTagsOrArticles = async(ctx, next) => {\n  let { id } = ctx.params, data\n  if (id) {\n    try {\n      data = await Article.find({ publish: true, tags: [id] })\n        .populate({\n          path: 'tags',\n          select: 'id name'\n        })\n        .sort({ 'updatedAt': -1 })\n        .exec()\n      ctx.body = {\n        success: true,\n        data: data\n      }\n    } catch (e) {\n      ctx.body = {\n        success: false,\n        err: e\n      }\n    }\n  } else {\n    data = await Tag.find({}).sort({ 'updatedAt': -1 }).exec()\n    ctx.body = {\n      success: true,\n      data: data\n    }\n  }\n}\n\nexport const postTag = async(ctx, next) => {\n  let body = ctx.request.body\n  let { name } = body\n\n  if (!name) {\n    return (ctx.body = {\n      success: false,\n      err: 'Tag name is required'\n    })\n  }\n\n  try {\n    body = new Tag(body)\n    await body.save()\n    ctx.body = {\n      success: true,\n      data: body\n    }\n  } catch (e) {\n    ctx.body = {\n      success: false,\n      err: e\n    }\n  }\n}\n\nexport const patchTag = async(ctx, next) => {\n  let body = ctx.request.body\n  body.updatedAt = Date.now()\n  const { id } = body\n  if (!id) {\n    return (ctx.body = {\n      success: false,\n      err: 'id is required'\n    })\n  }\n\n  try {\n    body = await Tag.findByIdAndUpdate(id, body).exec()\n    ctx.body = {\n      success: true,\n      data: body\n    }\n  } catch (e) {\n    ctx.body = {\n      success: false,\n      err: e\n    }\n  }\n}\n\nexport const deleteTag = async(ctx, next) => {\n  let { id } = ctx.params\n\n  if (!id) {\n    return (ctx.body = {\n      success: false,\n      err: 'id is required'\n    })\n  }\n\n  try {\n    let body = await Tag.findByIdAndRemove(id).exec()\n    ctx.body = {\n      success: true,\n      data: body\n    }\n  } catch (e) {\n    ctx.body = {\n      success: false,\n      err: e\n    }\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./server/controllers/tag.js","import mongoose from 'mongoose'\nimport path from 'path'\nimport fs from 'fs'\nimport formidable from 'formidable'\nconst Article = mongoose.model('Article')\n\nexport const getArticles = async(ctx, next) => {\n  let { page = 1, limit = 15 } = ctx.params\n  page = Number((page - 1) * limit) || 0\n  limit = Number(limit) || 15\n\n  try {\n    let total = await Article.find({ publish: true }).exec()\n    total = total.length\n    const data = await Article.find({ publish: true })\n      .populate({\n        path: 'tags',\n        select: 'id name'\n      })\n      .skip(page)\n      .limit(limit)\n      .sort({'createdAt': -1})\n      .exec()\n    ctx.body = {\n      success: true,\n      data: data,\n      total: total\n    }\n  } catch (e) {\n    ctx.body = {\n      success: false,\n      err: e,\n      total: 0\n    }\n  }\n}\n\nexport const getPrivateArticles = async(ctx, next) => {\n  const data = await Article.find({ publish: false })\n    .populate({\n      path: 'tags',\n      select: 'id name'\n    })\n    .sort({'updatedAt': -1})\n    .exec()\n  ctx.body = {\n    success: true,\n    data: data\n  }\n}\n\nexport const getArticle = async(ctx, next) => {\n  let { id } = ctx.params\n  if (!id) {\n    return (ctx.body = {\n      success: false,\n      err: 'id is required'\n    })\n  }\n\n  try {\n    let article = await Article.findOne({ _id: id })\n      .populate({\n        path: 'tags',\n        select: 'id name'\n      })\n      .exec()\n    await Article.findByIdAndUpdate(id, {views: article.views + 1}).exec()\n    ctx.body = {\n      success: true,\n      data: article\n    }\n  } catch (e) {\n    // console.log(e)\n    ctx.body = {\n      success: false,\n      err: e\n    }\n  }\n}\n\nexport const postArticle = async(ctx, next) => {\n  let body = ctx.request.body\n  let { title, content, publish } = body\n  if (!title || !content || !String(publish)) {\n    return (ctx.body = {\n      success: false,\n      err: 'Field incomplete'\n    })\n  }\n\n  try {\n    body = await new Article(body)\n    await body.save()\n    // when save article, we can replace id to object\n    // await body.populate('tags').execPopulate()\n    ctx.body = {\n      success: true,\n      data: body\n    }\n  } catch (e) {\n    ctx.body = {\n      success: false,\n      err: e\n    }\n  }\n}\n\n// modify publish article or private article\nexport const patchArticle = async(ctx, next) => {\n  let body = ctx.request.body\n  body.updatedAt = Date.now()\n  let { id, title, content, publish } = body\n  if (!id || !title || !content || !String(publish)) {\n    return (ctx.body = {\n      success: false,\n      err: 'Field incomplete'\n    })\n  }\n\n  try {\n    body = await Article.findByIdAndUpdate(id, body).exec()\n    ctx.body = {\n      success: true,\n      data: body\n    }\n  } catch (e) {\n    ctx.body = {\n      success: false,\n      err: e\n    }\n  }\n}\n\nexport const deleteArticle = async(ctx, next) => {\n  let { id } = ctx.params\n\n  if (!id) {\n    return (ctx.body = {\n      success: false,\n      err: 'id is required'\n    })\n  }\n\n  try {\n    let body = await Article.findByIdAndRemove(id).exec()\n    ctx.body = {\n      success: true,\n      data: body\n    }\n  } catch (e) {\n    ctx.body = {\n      success: false,\n      err: e\n    }\n  }\n}\n\nexport const search = async(ctx, next) => {\n  const { keyword } = ctx.params\n  const reg = new RegExp(keyword, 'i')\n  try {\n    let body = await Article.find({\n      publish: true,\n      $or: [{ title: { $regex: reg } }]\n    })\n      .sort({'createdAt': -1})\n      .exec()\n    ctx.body = {\n      success: true,\n      data: body\n    }\n  } catch (e) {\n    ctx.body = {\n      success: false,\n      err: e\n    }\n  }\n}\n\nexport const archives = async(ctx, next) => {\n  let articles = await Article.find({ publish: true })\n    .populate({\n      path: 'tags',\n      select: 'id name'\n    })\n    .select('id title tags createdAt updatedAt')\n    .sort({'createdAt': -1})\n    .exec()\n  let arr = [],\n    arr2 = [],\n    year, month, date\n  for (let i = 0; i < articles.length; i++) {\n    year = new Date(articles[i].createdAt).getFullYear() + ''\n    month = new Date(articles[i].createdAt).getMonth() + 1 + ''\n    if (month.length === 1) {\n      month = '0' + month\n    }\n    date = `${year}년 ${month}월`\n    arr.push({\n      date: date,\n      article: articles[i]\n    })\n  }\n\n  for (let i = 0; i < arr.length;) {\n    let total = 0,\n      archiveArticles = []\n    for (let j = i; j < arr.length; j++) {\n      if (arr[i].date === arr[j].date) {\n        archiveArticles.push(arr[j].article)\n        total++\n      }\n    }\n    arr2.push({\n      date: arr[i].date,\n      articles: archiveArticles,\n      total: total\n    })\n    i += total\n  }\n\n  ctx.body = {\n    success: true,\n    data: arr2\n  }\n}\n\nexport const upload = async(ctx, next) => {\n  let form = new formidable.IncomingForm()\n\n  function getImgUrl(ctx) {\n    return new Promise((resolve, reject) => {\n      form.parse(ctx.req, function (err, fields, files) {\n        if (err) {\n          ////console.log(err)\n          reject(err)\n        }\n        // console.log(files)\n        let lastItem = files[Object.keys(files)[Object.keys(files).length - 1]]\n\n        // fetch file extname\n        let extname = Date.now() + path.extname(lastItem.name)\n        let oldUrl = lastItem.path\n        let newUrl = './public/' + extname\n\n        // modify file name and upload file\n        let readStream = fs.createReadStream(oldUrl)\n        let writeStream = fs.createWriteStream(newUrl)\n        readStream.pipe(writeStream)\n        let imgUrl = ctx.protocol + '://' + ctx.host + '/public/' + extname\n        resolve(imgUrl)\n      })\n    })\n  }\n\n  await getImgUrl(ctx).then((url) => {\n    ctx.body = url\n  })\n}\n\n\n\n// WEBPACK FOOTER //\n// ./server/controllers/article.js","module.exports = require(\"path\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"path\"\n// module id = 24\n// module chunks = 0","module.exports = require(\"fs\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"fs\"\n// module id = 25\n// module chunks = 0","module.exports = require(\"formidable\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"formidable\"\n// module id = 26\n// module chunks = 0"],"sourceRoot":""}